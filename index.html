<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<meta charset="utf-8">
		<link rel="manifest" href="manifest.json">
	</head>
	<body>
		<h3>Entra a este sitio desde Chrome >42 un dispositivo móvil.</h3>

		<p>Habilita este flag chrome://flags/#bypass-app-banner-engagement-checks o visita el sitio dos veces en la misma semana.</p>
		
		<p>Vas a ver un mensaje solicitando agregar la página actual al escritorio del dispositivo.</p>
		
		<img src="https://cloud.githubusercontent.com/assets/7959823/10120559/126cfeaa-6487-11e5-98ad-89883596cb85.png" alt="Banner">
		<script>
			var outputElement = document.getElementById('output');
			if ('serviceWorker' in navigator) {
			  navigator.serviceWorker.register('./sw.js').then(function(registration) {
			    // :)
			    console.log('ServiceWorker registration successful with scope: ', registration.scope);
			  }).catch(function(err) {
			    // :(
			    console.log('ServiceWorker registration failed: ', err);
			  });
			}
			

			(function() {
				var deferredPrompt;

				window.addEventListener('beforeinstallprompt', function(e) {
				  console.log('beforeinstallprompt Event fired');
				  e.preventDefault();
				  
				  // Stash the event so it can be triggered later.
				  deferredPrompt = e;
				  
				  return false;
				});
				if(deferredPrompt !== undefined) {
					// The user has had a postive interaction with our app and Chrome
					// has tried to prompt previously, so let's show the prompt.
					deferredPrompt.prompt();

					// Follow what the user has done with the prompt.
					deferredPrompt.userChoice.then(function(choiceResult) {

					  console.log(choiceResult.outcome);
					  
					  if(choiceResult.outcome == 'dismissed') {
					    console.log('User cancelled home screen install');
					  }
					  else {
					    console.log('User added to home screen');
					  }
					  
					  // We no longer need the prompt.  Clear it up.
					  deferredPrompt = null;
					});
				}
			})();

		</script>
	</body>
</html>